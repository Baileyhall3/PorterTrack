<ListItemWithCheckbox>:
    id: the_list_item
    markup: True
    on_press:
        self.show_task_info_dialog()

    LeftCheckbox:
        id: check
        on_release:
            root.mark_complete(check, the_list_item)

    IconRightWidget:
        icon: 'trash-can-outline'
        theme_text_color: "Custom"
        text_color: 1, 0, 0, 1
        on_release:
            root.delete_task(the_list_item)

<DialogContent>:
    id: task_info
    size_hint: 1, None
    size: 300, 400
    pos_hint : {"center_x": 0.5, "center_y": 0.5}
    elevation: 3
    padding: 25
    spacing: "10dp"
    orientation: 'vertical'


    MDLabel:
        id: tasktype
        text: "Current Task"
        font_size: 28
        halign: 'center'
        size_hint_y: None
        height: self.texture_size[1]

    MDLabel:
        id: origin
        text: "From:"
        font_size: 15
        size_hint: (0.98, 0.5)
        pos_hint: {"center_x": 0.5, "y": 0.9}

    MDLabel:
        id: destination
        text: "To:"
        font_size: 15
        size_hint: (0.98, 1)
        pos_hint: {"center_x": 0.5, "y": 0.85}

    MDLabel:
        id: equipment
        text: "Using:"
        font_size: 15
        size_hint: (0.98, 1)
        pos_hint: {"center_x": 0.5, "y": 0.8}

    MDLabel:
        id: time
        text: "Time:"
        font_size: 15
        size_hint: (0.98, 1)
        pos_hint: {"center_x": 0.5, "y": 0.75}

    MDLabel:
        id: pname
        text: "Patient Name:"
        font_size: 15
        size_hint: (0.98, 1)
        pos_hint: {"center_x": 0.5, "y": 0.75}

    MDFloatLayout:
        MDFillRoundFlatIconButton
            icon: "check"
            text: "COMPLETE"
            theme_text_color: "Custom"
            text_color: "white"
            pos_hint: {'x': 0.55, 'y': 0.1}
            on_release:
                app.mark_complete(check, the_list_item)

        MDFillRoundFlatIconButton
            icon: "window-close"
            text: "CANCEL"
            theme_text_color: "Custom"
            text_color: "white"
            md_bg_color: "red"
            pos_hint: {'x': 0.01, 'y': 0.1}
            on_press:
                app.change_screen("main")



Screen:

    MDTopAppBar:
        id: topbar
        markup: True
        pos_hint: {"top": 1}
        title: "[font=Roboto][size=48][i]PorterTrack[/i][/size][/font]"
        left_action_items: [["menu", lambda x: app.open_nav_drawer()]]
        right_action_items: [["plus", lambda x: app.open_task_window()]]
        elevation: 0.8
    Widget:



    MDNavigationLayout:

        ScreenManager:
            id: screen_manager

            Screen:
                name: 'main'

                ScrollView:
                    do_scroll_x: False
                    size_hint: 1, 0.92
                    pos_hint: {"top": 0.85}

                    MDList:
                        id: container1


            Screen:
                name: 'booked_tasks'
                MDFloatLayout:
                    orientation: 'vertical'

                    MDLabel:
                        markup: True
                        text: "[i][b]Booked Tasks[b][/i]"
                        font_size: 18
                        halign: "center"
                        pos_hint: {"x": 0.0, "y": 0.55}
                        size_hint: (1, 0.5)

                    ScrollView:
                        do_scroll_x: False
                        pos_hint: {'y': .15, 'center_x': .5}
                        size_hint: .9, .6

                        MDList:
                            id: container1


            Screen:
                name: 'messenger'
                MDBoxLayout:
                    orientation: 'vertical'
                    MDLabel:
                        markup: True
                        text: "[i][b]Messenger[b][/i]"
                        font_size: 18
                        halign: "center"

            Screen:
                name: 'completed_tasks'
                MDFloatLayout:
                    orientation: 'vertical'

                    MDLabel:
                        markup: True
                        text: "[i][b]Completed Tasks[b][/i]"
                        font_size: 18
                        halign: "center"
                        pos_hint: {"x": 0.0, "y": 0.55}
                        size_hint: (1, 0.5)

                    ScrollView:
                        do_scroll_x: False
                        pos_hint: {'y': .15, 'center_x': .5}
                        size_hint: .9, .6

                        MDList:
                            id: container2

            Screen:
                name: 'team'
                MDBoxLayout:
                    orientation: 'vertical'
                    MDLabel:
                        markup: True
                        text: "[i][b]My Team[b][/i]"
                        font_size: 18
                        halign: "center"
                        background_color: (0, 0, 0, 0.2)

            Screen:
                name: 'stats'
                MDBoxLayout:
                    orientation: 'vertical'
                    MDLabel:
                        markup: True
                        text: "[i][b]My Stats[b][/i]"
                        font_size: 18
                        halign: "center"
                        background_color: (0, 0, 0, 0.2)

            Screen:
                name: 'settings'
                MDBoxLayout:
                    orientation: 'vertical'
                    MDLabel:
                        markup: True
                        text: "[i][b]Settings[b][/i]"
                        font_size: 18
                        halign: "center"
                        background_color: (0, 0, 0, 0.2)


            Screen:
                name: 'complete_dialog_box'

                MDCard:
                    size_hint: None, None
                    size: 250, 200
                    pos_hint : {"center_x": 0.5, "center_y": 0.5}
                    elevation: 3
                    padding: 25
                    spacing: 25
                    orientation: 'vertical'

                    MDLabel:
                        text: "Complete Task"
                        font_size: 18
                        halign: 'center'
                        size_hint_y: None
                        height: self.texture_size[1]

                    MDLabel:
                        text: "Would you like to complete the current task?"
                        font_size: 14
                        halign: 'center'
                        size_hint_y: None

                    MDFloatLayout:

                        MDFillRoundFlatIconButton
                            icon: "check"
                            text: "YES"
                            theme_text_color: "Custom"
                            text_color: "white"
                            pos_hint: {'x': 0.65, 'y': 0.6}
                            on_release:
                                app.mark_complete(check, the_list_item)

                        MDFillRoundFlatIconButton
                            icon: "window-close"
                            text: "NO"
                            theme_text_color: "Custom"
                            text_color: "white"
                            md_bg_color: "red"
                            pos_hint: {'x': 0.01, 'y': 0.6}
                            on_press:
                                app.change_screen("main")


    MDNavigationDrawer:
        id: nav_drawer
        BoxLayout:
            orientation: 'vertical'
            spacing: '20dp'
            padding: [5,18,10,10]
            theme_text_color: 'Primary'

            MDLabel:
                text: 'Porter ID'
                font_style: 'Subtitle1'
                size_hint_y: None
                height: self.texture_size[1]
                background_color: (1, 1, 1, 0)

            ScrollView:
                MDList:
                    OneLineIconListItem:
                        text: 'Completed Tasks'
                        on_press:
                            app.change_screen("completed_tasks")
                            app.close_nav_drawer()
                        IconLeftWidget:
                            icon: 'clipboard-check-outline'
                    OneLineIconListItem:
                        text: 'My Team'
                        on_press:
                            app.change_screen("team")
                            app.close_nav_drawer()
                        IconLeftWidget:
                            icon: 'account-group'
                    OneLineIconListItem:
                        text: 'My Stats'
                        on_press:
                            app.change_screen("stats")
                            app.close_nav_drawer()
                        IconLeftWidget:
                            icon: 'chart-line'
                    OneLineIconListItem:
                        text: 'Settings'
                        on_press:
                            app.change_screen("settings")
                            app.close_nav_drawer()
                        IconLeftWidget:
                            icon: 'cog-outline'
                    OneLineIconListItem:
                        text: 'Logout'
                        IconLeftWidget:
                            icon: 'logout'

    MDBottomAppBar:
        MDTopAppBar:
            title: ""
            icon: "home"
            on_action_button: app.change_screen("main")
            type: "bottom"
            mode: "center"
            left_action_items: [["clipboard-text-outline", lambda x: app.change_screen("booked_tasks")]]
            right_action_items: [["message-reply-text-outline", lambda x: app.change_screen("messenger")]]
            font_size: 40
            elevation: 0
